\hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction}{}\doxysection{MODEL\+::Blood\+Vessel\+Junction\texorpdfstring{$<$}{<} T \texorpdfstring{$>$}{>} Class Template Reference}
\label{class_m_o_d_e_l_1_1_blood_vessel_junction}\index{MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}}


\mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{Blood\+Vessel\+Junction}}.  




{\ttfamily \#include $<$bloodvesseljunction.\+hpp$>$}



Inheritance diagram for MODEL\+::Blood\+Vessel\+Junction\texorpdfstring{$<$}{<} T \texorpdfstring{$>$}{>}\+:
% FIG 0
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction_acc5a95a3227288fd488bf783164ac177}{setup\+\_\+dofs}} (\mbox{\hyperlink{class_m_o_d_e_l_1_1_d_o_f_handler}{DOFHandler}} \&dofhandler)
\begin{DoxyCompactList}\small\item\em Set up the degrees of freedom (DOF) of the block. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction_a2545a5e8b647381a23ff090c7b2f2eee}{update\+\_\+constant}} (\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA\+::\+Sparse\+System}}$<$ T $>$ \&system, std\+::vector$<$ T $>$ \&parameters)
\begin{DoxyCompactList}\small\item\em Update the constant contributions of the element in a sparse system. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction_a23406660efe4c7537455b66859f82601}{update\+\_\+solution}} (\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA\+::\+Sparse\+System}}$<$ T $>$ \&system, std\+::vector$<$ T $>$ \&parameters, Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&y, Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&dy)
\begin{DoxyCompactList}\small\item\em Update the solution-\/dependent contributions of the element in a sparse system. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction_a171d2ed7c087fd817aacf5251b197976}{update\+\_\+gradient}} (Eigen\+::\+Sparse\+Matrix$<$ T $>$ \&jacobian, Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&residual, Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&alpha, std\+::vector$<$ T $>$ \&y, std\+::vector$<$ T $>$ \&dy)
\begin{DoxyCompactList}\small\item\em Set the gradient of the block contributions with respect to the parameters. \end{DoxyCompactList}\item 
std\+::map$<$ std\+::string, int $>$ \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction_af870a4e729ab45cc3974d71d70a9d64d}{get\+\_\+num\+\_\+triplets}} ()
\begin{DoxyCompactList}\small\item\em Get number of triplets of element. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::map$<$ std\+::string, int $>$ \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction_a6df2ab82ea5d01a27132722a795b5cff}{num\+\_\+triplets}}
\begin{DoxyCompactList}\small\item\em Number of triplets of element. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename T$>$\newline
class MODEL\+::\+Blood\+Vessel\+Junction$<$ T $>$}
\mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{Blood\+Vessel\+Junction}}. 

Models a junction with one inlet and arbitrary outlets using modified blood vessel elements between each inlet and outlet pair.

\[
\begin{circuitikz}
\draw node[left] {$Q_{in}$} [-latex] (0,0) -- (0.8,0);
\draw (1,0.1) node[anchor=south]{$P_{in}$};
\draw (1,0) to [short, *-] (2.5,0.75);
\draw (1,0) to [short, *-] (2.5,-0.75);
\draw (2.5,0.75) node[anchor=south]{} to [generic, l_=$BV_{1}$, -*]
(4.5,0.75); \draw (2.4,0.75) node[anchor=south]{}; \draw (4.6,0.75)
node[anchor=south] {$P_{out,1}$}; \draw (2.5,-0.75) node[anchor=south]{} to
[generic, l^=$BV_{2}$, -*] (4.5,-0.75); \draw (2.4,-0.75)
node[anchor=north]{}; \draw (4.6,-0.75) node[anchor=north]
{$P_{out,2}$}; \draw [-latex] (4.7,0.75) -- (5.5,0.75) node[right]
{$Q_{out,1}$}; \draw [-latex] (4.7,-0.75) -- (5.5,-0.75) node[right]
{$Q_{out,2}$}; \end{circuitikz} \]

Each blood vessel is modelled as\+:

\[
\begin{circuitikz} \draw
node[left] {$Q_{in}$} [-latex] (0,0) -- (0.8,0);
\draw (1,0) node[anchor=south]{$P_{in}$}
to [R, l=$R$, *-] (3,0)
to [R, l=$R_{ste}$, -] (5,0)
(5,0) to [L, l=$L$, -*] (7,0)
node[anchor=south]{$P_{out}$};
\draw [-latex] (7.2,0) -- (8,0) node[right] {$Q_{out}$};
\end{circuitikz}
\]\hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md4}{}\doxyparagraph{Governing equations}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md4}
\[
Q_{in}-\sum_{i}^{n_{outlets}} Q_{out, i}
\]

\[
P_{in}-P_{out,i} - (R+R_{ste}) \cdot Q_{out,i} -
L \frac{d Q_{out,i}}{d t} \quad \forall i \in n_{outlets} \]\hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md5}{}\doxyparagraph{Local contributions}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md5}
\[
\mathbf{y}^{e}=\left[\begin{array}{lllllll}P_{in}^{e} & Q_{in}^{e}
& P_{out, 1}^{e} & Q_{out, 1}^{e} &
\dots & P_{out, i}^{e} & Q_{out, i}^{e}\end{array}\right] \]

\[
\mathbf{F}^{e} = \left[\begin{array}{lllllllll}
0 & 1 & 0 & -1 & 0 & -1 & 0 & -1 & \dots \\
1 & 0 & -1 & -R_{1}-R_{ste,1} & 0 & 0 & 0 & 0 & \dots\\
1 & 0 & 0 & 0 & -1 & -R_{2}-R_{ste,2} & 0& 0& \dots \\
\vdots & & & & & \ddots & \ddots & &
\end{array}\right]
\]

\[
\mathbf{E}^{e} = \left[\begin{array}{lllllllll}
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \dots \\
0 & 0 & 0 & -L_{1} & 0 & 0 & 0 & 0 & \dots\\
0 & 0 & 0 & 0 & 0 & -L_{2} & 0 & 0 & \dots\\
& & & & & \ddots & \ddots & &
\end{array}\right]
\]

\[
\mathbf{D}^{e} = \left[\begin{array}{lllllllll}
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \dots \\
0 & 0 & 0 &
-R_{ste,1} & 0 & 0 & 0 & 0 & \dots\\
0 & 0 & 0 & 0 & 0 & -R_{ste,2} & 0 & 0 & \dots\\ & & & & & \ddots & \ddots &
& \end{array}\right] \]\hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md6}{}\doxyparagraph{Gradient}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md6}
Gradient of the equations with respect to the parameters\+:

\[
\mathbf{J}^{e} = \left[\begin{array}{lllllllll}
0 & 0 & \dots & 0 & 0 & \dots & 0 & 0 &
\dots \\
- y_4 & 0 & \dots & - \dot y_4 & 0 & \dots & |y_4| y_4 & 0 & \dots \\
0 & - y_6 & \dots & 0 & - \dot y_6 & \dots & 0 & |y_6| y_6 & \dots \\
0 & 0 & \ddots & 0 & 0 & \ddots & 0 & 0 & \ddots \\
\end{array}\right]
\]\hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md7}{}\doxyparagraph{Parameters}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_autotoc_md7}
\mbox{\hyperlink{class_m_o_d_e_l_1_1_parameter}{Parameter}} sequence for constructing this block


\begin{DoxyItemize}
\item {\ttfamily i} Poiseuille resistance for inner blood vessel {\ttfamily i}
\item {\ttfamily i+num\+\_\+outlets} Inductance for inner blood vessel {\ttfamily i}
\item {\ttfamily i+2$\ast$num\+\_\+outlets} Stenosis coefficient for inner blood vessel {\ttfamily i}
\end{DoxyItemize}


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & Scalar type (e.\+g. {\ttfamily float}, {\ttfamily double}) \\
\hline
\end{DoxyTemplParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_af870a4e729ab45cc3974d71d70a9d64d}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_af870a4e729ab45cc3974d71d70a9d64d}} 
\index{MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}!get\_num\_triplets@{get\_num\_triplets}}
\index{get\_num\_triplets@{get\_num\_triplets}!MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{get\_num\_triplets()}{get\_num\_triplets()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::map$<$ std\+::string, int $>$ \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{MODEL\+::\+Blood\+Vessel\+Junction}}$<$ T $>$\+::get\+\_\+num\+\_\+triplets\hspace{0.3cm}{\ttfamily [virtual]}}



Get number of triplets of element. 

Number of triplets that the element contributes to the global system (relevant for sparse memory reservation) 

Reimplemented from \mbox{\hyperlink{class_m_o_d_e_l_1_1_block_ae68725b7b8add13e1d182ce46fca76d2}{MODEL\+::\+Block$<$ T $>$}}.

\mbox{\Hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_acc5a95a3227288fd488bf783164ac177}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_acc5a95a3227288fd488bf783164ac177}} 
\index{MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}!setup\_dofs@{setup\_dofs}}
\index{setup\_dofs@{setup\_dofs}!MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{setup\_dofs()}{setup\_dofs()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{MODEL\+::\+Blood\+Vessel\+Junction}}$<$ T $>$\+::setup\+\_\+dofs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_m_o_d_e_l_1_1_d_o_f_handler}{DOFHandler}} \&}]{dofhandler }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Set up the degrees of freedom (DOF) of the block. 

Set \mbox{\hyperlink{class_m_o_d_e_l_1_1_block_a0dc20753b52a12c3e8f094f26755cc60}{global\+\_\+var\+\_\+ids}} and \mbox{\hyperlink{class_m_o_d_e_l_1_1_block_ad338703d131cb419b5d85af5b6527108}{global\+\_\+eqn\+\_\+ids}} of the element based on the number of equations and the number of internal variables of the element.


\begin{DoxyParams}{Parameters}
{\em dofhandler} & Degree-\/of-\/freedom handler to register variables and equations at \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_m_o_d_e_l_1_1_block_a70ccd1dd5919a360d520a6e8320dfecf}{MODEL\+::\+Block$<$ T $>$}}.

\mbox{\Hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_a2545a5e8b647381a23ff090c7b2f2eee}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_a2545a5e8b647381a23ff090c7b2f2eee}} 
\index{MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}!update\_constant@{update\_constant}}
\index{update\_constant@{update\_constant}!MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{update\_constant()}{update\_constant()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{MODEL\+::\+Blood\+Vessel\+Junction}}$<$ T $>$\+::update\+\_\+constant (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA\+::\+Sparse\+System}}$<$ T $>$ \&}]{system,  }\item[{std\+::vector$<$ T $>$ \&}]{parameters }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Update the constant contributions of the element in a sparse system. 


\begin{DoxyParams}{Parameters}
{\em system} & System to update contributions at \\
\hline
{\em parameters} & Parameters of the model \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_m_o_d_e_l_1_1_block_abd4e9b82b5c3cff5463a0b2ada6d4f16}{MODEL\+::\+Block$<$ T $>$}}.

\mbox{\Hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_a171d2ed7c087fd817aacf5251b197976}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_a171d2ed7c087fd817aacf5251b197976}} 
\index{MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}!update\_gradient@{update\_gradient}}
\index{update\_gradient@{update\_gradient}!MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{update\_gradient()}{update\_gradient()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{MODEL\+::\+Blood\+Vessel\+Junction}}$<$ T $>$\+::update\+\_\+gradient (\begin{DoxyParamCaption}\item[{Eigen\+::\+Sparse\+Matrix$<$ T $>$ \&}]{jacobian,  }\item[{Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&}]{residual,  }\item[{Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&}]{alpha,  }\item[{std\+::vector$<$ T $>$ \&}]{y,  }\item[{std\+::vector$<$ T $>$ \&}]{dy }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Set the gradient of the block contributions with respect to the parameters. 


\begin{DoxyParams}{Parameters}
{\em jacobian} & Jacobian with respect to the parameters \\
\hline
{\em alpha} & Current parameter vector \\
\hline
{\em residual} & Residual with respect to the parameters \\
\hline
{\em y} & Current solution \\
\hline
{\em dy} & Time-\/derivative of the current solution \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_m_o_d_e_l_1_1_block_aa421ffde1a0c16eec27e463e4a816482}{MODEL\+::\+Block$<$ T $>$}}.

\mbox{\Hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_a23406660efe4c7537455b66859f82601}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_a23406660efe4c7537455b66859f82601}} 
\index{MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}!update\_solution@{update\_solution}}
\index{update\_solution@{update\_solution}!MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{update\_solution()}{update\_solution()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{MODEL\+::\+Blood\+Vessel\+Junction}}$<$ T $>$\+::update\+\_\+solution (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA\+::\+Sparse\+System}}$<$ T $>$ \&}]{system,  }\item[{std\+::vector$<$ T $>$ \&}]{parameters,  }\item[{Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&}]{y,  }\item[{Eigen\+::\+Matrix$<$ T, Eigen\+::\+Dynamic, 1 $>$ \&}]{dy }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Update the solution-\/dependent contributions of the element in a sparse system. 


\begin{DoxyParams}{Parameters}
{\em system} & System to update contributions at \\
\hline
{\em parameters} & Parameters of the model \\
\hline
{\em y} & Current solution \\
\hline
{\em dy} & Current derivate of the solution \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_m_o_d_e_l_1_1_block_a3fabdf1b9d391665fca5e7dbe9b0f69a}{MODEL\+::\+Block$<$ T $>$}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{class_m_o_d_e_l_1_1_blood_vessel_junction_a6df2ab82ea5d01a27132722a795b5cff}\label{class_m_o_d_e_l_1_1_blood_vessel_junction_a6df2ab82ea5d01a27132722a795b5cff}} 
\index{MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}!num\_triplets@{num\_triplets}}
\index{num\_triplets@{num\_triplets}!MODEL::BloodVesselJunction$<$ T $>$@{MODEL::BloodVesselJunction$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{num\_triplets}{num\_triplets}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::map$<$std\+::string, int$>$ \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{MODEL\+::\+Blood\+Vessel\+Junction}}$<$ T $>$\+::num\+\_\+triplets}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{      \{\textcolor{stringliteral}{"{}F"{}}, 0\},}
\DoxyCodeLine{      \{\textcolor{stringliteral}{"{}E"{}}, 0\},}
\DoxyCodeLine{      \{\textcolor{stringliteral}{"{}D"{}}, 0\},}
\DoxyCodeLine{  \}}

\end{DoxyCode}


Number of triplets of element. 

Number of triplets that the element contributes to the global system (relevant for sparse memory reservation) 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
model/\mbox{\hyperlink{bloodvesseljunction_8hpp}{bloodvesseljunction.\+hpp}}\end{DoxyCompactItemize}
