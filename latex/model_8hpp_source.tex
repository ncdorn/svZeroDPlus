\hypertarget{model_8hpp_source}{}\doxysection{model.\+hpp}
\label{model_8hpp_source}\index{model/model.hpp@{model/model.hpp}}
\mbox{\hyperlink{model_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright (c) Stanford University, The Regents of the University of}}
\DoxyCodeLine{2 \textcolor{comment}{//               California, and others.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// All Rights Reserved.}}
\DoxyCodeLine{5 \textcolor{comment}{//}}
\DoxyCodeLine{6 \textcolor{comment}{// See Copyright-\/SimVascular.txt for additional details.}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{// Permission is hereby granted, free of charge, to any person obtaining}}
\DoxyCodeLine{9 \textcolor{comment}{// a copy of this software and associated documentation files (the}}
\DoxyCodeLine{10 \textcolor{comment}{// "{}Software"{}), to deal in the Software without restriction, including}}
\DoxyCodeLine{11 \textcolor{comment}{// without limitation the rights to use, copy, modify, merge, publish,}}
\DoxyCodeLine{12 \textcolor{comment}{// distribute, sublicense, and/or sell copies of the Software, and to}}
\DoxyCodeLine{13 \textcolor{comment}{// permit persons to whom the Software is furnished to do so, subject}}
\DoxyCodeLine{14 \textcolor{comment}{// to the following conditions:}}
\DoxyCodeLine{15 \textcolor{comment}{//}}
\DoxyCodeLine{16 \textcolor{comment}{// The above copyright notice and this permission notice shall be included}}
\DoxyCodeLine{17 \textcolor{comment}{// in all copies or substantial portions of the Software.}}
\DoxyCodeLine{18 \textcolor{comment}{//}}
\DoxyCodeLine{19 \textcolor{comment}{// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "{}AS}}
\DoxyCodeLine{20 \textcolor{comment}{// IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED}}
\DoxyCodeLine{21 \textcolor{comment}{// TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A}}
\DoxyCodeLine{22 \textcolor{comment}{// PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER}}
\DoxyCodeLine{23 \textcolor{comment}{// OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,}}
\DoxyCodeLine{24 \textcolor{comment}{// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,}}
\DoxyCodeLine{25 \textcolor{comment}{// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR}}
\DoxyCodeLine{26 \textcolor{comment}{// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF}}
\DoxyCodeLine{27 \textcolor{comment}{// LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING}}
\DoxyCodeLine{28 \textcolor{comment}{// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}}
\DoxyCodeLine{29 \textcolor{comment}{// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}\textcolor{comment}{}}
\DoxyCodeLine{30 \textcolor{comment}{/**}}
\DoxyCodeLine{31 \textcolor{comment}{ * @file model.hpp}}
\DoxyCodeLine{32 \textcolor{comment}{ * @brief MODEL::Model source file}}
\DoxyCodeLine{33 \textcolor{comment}{ */}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#ifndef SVZERODSOLVER\_MODEL\_MODEL\_HPP\_}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#define SVZERODSOLVER\_MODEL\_MODEL\_HPP\_}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include <list>}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{preprocessor}{\#include "{}../algebra/sparsesystem.hpp"{}}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#include "{}../model/bloodvessel.hpp"{}}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#include "{}../model/bloodvesseljunction.hpp"{}}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#include "{}../model/closedloopRCRbc.hpp"{}}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#include "{}../model/closedloopcoronarybc.hpp"{}}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#include "{}../model/closedloopheartpulmonary.hpp"{}}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#include "{}../model/flowreferencebc.hpp"{}}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#include "{}../model/junction.hpp"{}}}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#include "{}../model/openloopcoronarybc.hpp"{}}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#include "{}../model/pressurereferencebc.hpp"{}}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#include "{}../model/resistancebc.hpp"{}}}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#include "{}../model/resistivejunction.hpp"{}}}
\DoxyCodeLine{54 \textcolor{preprocessor}{\#include "{}../model/windkesselbc.hpp"{}}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{block_8hpp}{block.hpp}}"{}}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{blocktype_8hpp}{blocktype.hpp}}"{}}}
\DoxyCodeLine{57 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{dofhandler_8hpp}{dofhandler.hpp}}"{}}}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{node_8hpp}{node.hpp}}"{}}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{parameter_8hpp}{parameter.hpp}}"{}}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_m_o_d_e_l}{MODEL}} \{}
\DoxyCodeLine{62 \textcolor{comment}{}}
\DoxyCodeLine{63 \textcolor{comment}{/**}}
\DoxyCodeLine{64 \textcolor{comment}{ * @brief Model of 0D elements}}
\DoxyCodeLine{65 \textcolor{comment}{ *}}
\DoxyCodeLine{66 \textcolor{comment}{ * This class represents a full 0D model. It contains attributes and}}
\DoxyCodeLine{67 \textcolor{comment}{ * methods to store and modify 0D elements.}}
\DoxyCodeLine{68 \textcolor{comment}{ *}}
\DoxyCodeLine{69 \textcolor{comment}{ * @tparam T Scalar type (e.g. `float`, `double`)}}
\DoxyCodeLine{70 \textcolor{comment}{ */}}
\DoxyCodeLine{71 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{72 \textcolor{keyword}{class }\mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{Model}} \{}
\DoxyCodeLine{73  \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{74 \textcolor{comment}{  /**}}
\DoxyCodeLine{75 \textcolor{comment}{   * @brief Construct a new Model object}}
\DoxyCodeLine{76 \textcolor{comment}{   *}}
\DoxyCodeLine{77 \textcolor{comment}{   */}}
\DoxyCodeLine{78   \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a75204aff4fddcf2032dd5c3e01c05433}{Model}}();}
\DoxyCodeLine{79 \textcolor{comment}{}}
\DoxyCodeLine{80 \textcolor{comment}{  /**}}
\DoxyCodeLine{81 \textcolor{comment}{   * @brief Destroy the Model object}}
\DoxyCodeLine{82 \textcolor{comment}{   *}}
\DoxyCodeLine{83 \textcolor{comment}{   */}}
\DoxyCodeLine{84   \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_af906fc8d73cea59e804174a828468f23}{\string~Model}}();}
\DoxyCodeLine{85 }
\DoxyCodeLine{86   \mbox{\hyperlink{class_m_o_d_e_l_1_1_d_o_f_handler}{DOFHandler}} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a43b9cc3c9874be9c2baeae576271fbad}{dofhandler}};  \textcolor{comment}{///< Degree-\/of-\/freedom handler of the model}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88   T \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a53cd0e0f133a5a3fb8a3bc86ce3b46c3}{cardiac\_cycle\_period}} = -\/1.0;  \textcolor{comment}{///< Cardiac cycle period}}
\DoxyCodeLine{89   T \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_abc13b2b82ef86f7042249678c2ae26f5}{time}} = 0.0;                   \textcolor{comment}{///< Current time}}
\DoxyCodeLine{90 \textcolor{comment}{}}
\DoxyCodeLine{91 \textcolor{comment}{  /**}}
\DoxyCodeLine{92 \textcolor{comment}{   * @brief Add a block to the model}}
\DoxyCodeLine{93 \textcolor{comment}{   *}}
\DoxyCodeLine{94 \textcolor{comment}{   * @param block\_type Type of the block}}
\DoxyCodeLine{95 \textcolor{comment}{   * @param block\_param\_ids Global IDs of the parameters of the block}}
\DoxyCodeLine{96 \textcolor{comment}{   * @param name The name of the block}}
\DoxyCodeLine{97 \textcolor{comment}{   * @param internal Toggle whether block is internal}}
\DoxyCodeLine{98 \textcolor{comment}{   * @return int Global ID of the block}}
\DoxyCodeLine{99 \textcolor{comment}{   */}}
\DoxyCodeLine{100   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_afbc4e91afadea5bddfc78241d54200c6}{add\_block}}(\mbox{\hyperlink{namespace_m_o_d_e_l_abfc4730d81d2da4910968e593aec2fe3}{BlockType}} block\_type, \textcolor{keyword}{const} std::vector<int> \&block\_param\_ids,}
\DoxyCodeLine{101                 std::string\_view name, \textcolor{keywordtype}{bool} internal = \textcolor{keyword}{false});}
\DoxyCodeLine{102 \textcolor{comment}{}}
\DoxyCodeLine{103 \textcolor{comment}{  /**}}
\DoxyCodeLine{104 \textcolor{comment}{   * @brief Get a block by its name}}
\DoxyCodeLine{105 \textcolor{comment}{   *}}
\DoxyCodeLine{106 \textcolor{comment}{   * @param name Name of the Block}}
\DoxyCodeLine{107 \textcolor{comment}{   * @return Block<T>* The block}}
\DoxyCodeLine{108 \textcolor{comment}{   */}}
\DoxyCodeLine{109   \mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ac3ba9eb815bf3f94a35747034baa357c}{get\_block}}(std::string\_view name);}
\DoxyCodeLine{110 \textcolor{comment}{}}
\DoxyCodeLine{111 \textcolor{comment}{  /**}}
\DoxyCodeLine{112 \textcolor{comment}{   * @brief Get a block by its global ID}}
\DoxyCodeLine{113 \textcolor{comment}{   *}}
\DoxyCodeLine{114 \textcolor{comment}{   * @param block\_id Global ID of the Block}}
\DoxyCodeLine{115 \textcolor{comment}{   * @return Block<T>* The block}}
\DoxyCodeLine{116 \textcolor{comment}{   */}}
\DoxyCodeLine{117   \mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ac3ba9eb815bf3f94a35747034baa357c}{get\_block}}(\textcolor{keywordtype}{int} block\_id);}
\DoxyCodeLine{118 \textcolor{comment}{}}
\DoxyCodeLine{119 \textcolor{comment}{  /**}}
\DoxyCodeLine{120 \textcolor{comment}{   * @brief Get a block type by its name}}
\DoxyCodeLine{121 \textcolor{comment}{   *}}
\DoxyCodeLine{122 \textcolor{comment}{   * @param block\_id Global ID of the Block}}
\DoxyCodeLine{123 \textcolor{comment}{   * @return BlockType The block type}}
\DoxyCodeLine{124 \textcolor{comment}{   */}}
\DoxyCodeLine{125   \mbox{\hyperlink{namespace_m_o_d_e_l_abfc4730d81d2da4910968e593aec2fe3}{BlockType}} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a7b2952c25a762846f7cc4f9e5e07b1d9}{get\_block\_type}}(std::string\_view name);}
\DoxyCodeLine{126 \textcolor{comment}{}}
\DoxyCodeLine{127 \textcolor{comment}{  /**}}
\DoxyCodeLine{128 \textcolor{comment}{   * @brief Get the name of a block by it's ID}}
\DoxyCodeLine{129 \textcolor{comment}{   *}}
\DoxyCodeLine{130 \textcolor{comment}{   * @param block\_id Global ID of the block}}
\DoxyCodeLine{131 \textcolor{comment}{   * @return std::string Name of the block}}
\DoxyCodeLine{132 \textcolor{comment}{   */}}
\DoxyCodeLine{133   std::string \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_aa208195d2e9db11fc256cea78882cc8d}{get\_block\_name}}(\textcolor{keywordtype}{int} block\_id);}
\DoxyCodeLine{134 \textcolor{comment}{}}
\DoxyCodeLine{135 \textcolor{comment}{  /**}}
\DoxyCodeLine{136 \textcolor{comment}{   * @brief Add a node to the model}}
\DoxyCodeLine{137 \textcolor{comment}{   *}}
\DoxyCodeLine{138 \textcolor{comment}{   * @param inlet\_eles Inlet blocks of the node}}
\DoxyCodeLine{139 \textcolor{comment}{   * @param outlet\_eles Outlet blocks of the node}}
\DoxyCodeLine{140 \textcolor{comment}{   * @return int Global ID of the node}}
\DoxyCodeLine{141 \textcolor{comment}{   */}}
\DoxyCodeLine{142   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ac197ebdc9d40d717af919ddcdf6cc027}{add\_node}}(\textcolor{keyword}{const} std::vector<\mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *> \&inlet\_eles,}
\DoxyCodeLine{143                \textcolor{keyword}{const} std::vector<\mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *> \&outlet\_eles,}
\DoxyCodeLine{144                std::string\_view name);}
\DoxyCodeLine{145 \textcolor{comment}{}}
\DoxyCodeLine{146 \textcolor{comment}{  /**}}
\DoxyCodeLine{147 \textcolor{comment}{   * @brief Get the name of a node by it's ID}}
\DoxyCodeLine{148 \textcolor{comment}{   *}}
\DoxyCodeLine{149 \textcolor{comment}{   * @param node\_id Global ID of the node}}
\DoxyCodeLine{150 \textcolor{comment}{   * @return std::string Name of the node}}
\DoxyCodeLine{151 \textcolor{comment}{   */}}
\DoxyCodeLine{152   std::string \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a219de975b955d05c1ca165e230543acc}{get\_node\_name}}(\textcolor{keywordtype}{int} node\_id);}
\DoxyCodeLine{153 \textcolor{comment}{}}
\DoxyCodeLine{154 \textcolor{comment}{  /**}}
\DoxyCodeLine{155 \textcolor{comment}{   * @brief Add a constant model parameter}}
\DoxyCodeLine{156 \textcolor{comment}{   *}}
\DoxyCodeLine{157 \textcolor{comment}{   * @param value Value of the parameter}}
\DoxyCodeLine{158 \textcolor{comment}{   * @return int Global ID of the parameter}}
\DoxyCodeLine{159 \textcolor{comment}{   */}}
\DoxyCodeLine{160   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a1840902a8446dd44f9f1c2c06021bcb0}{add\_parameter}}(T value);}
\DoxyCodeLine{161 \textcolor{comment}{}}
\DoxyCodeLine{162 \textcolor{comment}{  /**}}
\DoxyCodeLine{163 \textcolor{comment}{   * @brief Add a time-\/dependent model parameter}}
\DoxyCodeLine{164 \textcolor{comment}{   *}}
\DoxyCodeLine{165 \textcolor{comment}{   * @param times Times corresponding to the parameter values}}
\DoxyCodeLine{166 \textcolor{comment}{   * @param values Values of the parameter}}
\DoxyCodeLine{167 \textcolor{comment}{   * @param periodic Toggle whether parameter is periodic}}
\DoxyCodeLine{168 \textcolor{comment}{   * @return int Global ID of the parameter}}
\DoxyCodeLine{169 \textcolor{comment}{   */}}
\DoxyCodeLine{170   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a1840902a8446dd44f9f1c2c06021bcb0}{add\_parameter}}(\textcolor{keyword}{const} std::vector<T> \&times, \textcolor{keyword}{const} std::vector<T> \&values,}
\DoxyCodeLine{171                     \textcolor{keywordtype}{bool} periodic = \textcolor{keyword}{true});}
\DoxyCodeLine{172 \textcolor{comment}{}}
\DoxyCodeLine{173 \textcolor{comment}{  /**}}
\DoxyCodeLine{174 \textcolor{comment}{   * @brief Get a parameter by its global ID}}
\DoxyCodeLine{175 \textcolor{comment}{   *}}
\DoxyCodeLine{176 \textcolor{comment}{   * @param param\_id Global ID of the parameter}}
\DoxyCodeLine{177 \textcolor{comment}{   * @return Parameter<T>* The parameter}}
\DoxyCodeLine{178 \textcolor{comment}{   */}}
\DoxyCodeLine{179   \mbox{\hyperlink{class_m_o_d_e_l_1_1_parameter}{Parameter<T>}} *\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a3c1d8454b667144e39b42eff092ce360}{get\_parameter}}(\textcolor{keywordtype}{int} param\_id);}
\DoxyCodeLine{180 \textcolor{comment}{}}
\DoxyCodeLine{181 \textcolor{comment}{  /**}}
\DoxyCodeLine{182 \textcolor{comment}{   * @brief Get the current value of a parameter}}
\DoxyCodeLine{183 \textcolor{comment}{   *}}
\DoxyCodeLine{184 \textcolor{comment}{   * @param param\_id Global ID of the parameter}}
\DoxyCodeLine{185 \textcolor{comment}{   * @return T Current value of the parameter}}
\DoxyCodeLine{186 \textcolor{comment}{   */}}
\DoxyCodeLine{187   T \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a25e0f6d6c25184d67b9785712418403c}{get\_parameter\_value}}(\textcolor{keywordtype}{int} param\_id);}
\DoxyCodeLine{188 \textcolor{comment}{}}
\DoxyCodeLine{189 \textcolor{comment}{  /**}}
\DoxyCodeLine{190 \textcolor{comment}{   * @brief Update the current value of a parameter}}
\DoxyCodeLine{191 \textcolor{comment}{   *}}
\DoxyCodeLine{192 \textcolor{comment}{   * @param param\_id Global ID of the parameter}}
\DoxyCodeLine{193 \textcolor{comment}{   * @param param\_value The new parameter value}}
\DoxyCodeLine{194 \textcolor{comment}{   */}}
\DoxyCodeLine{195   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a6b16083a29f28a7a39f70129493757ee}{update\_parameter\_value}}(\textcolor{keywordtype}{int} param\_id, T param\_value);}
\DoxyCodeLine{196 \textcolor{comment}{}}
\DoxyCodeLine{197 \textcolor{comment}{  /**}}
\DoxyCodeLine{198 \textcolor{comment}{   * @brief Finalize the model after all blocks, nodes and parameters have been}}
\DoxyCodeLine{199 \textcolor{comment}{   * added}}
\DoxyCodeLine{200 \textcolor{comment}{   *}}
\DoxyCodeLine{201 \textcolor{comment}{   */}}
\DoxyCodeLine{202   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a39e6cc04b346f894bff1f9dad54ae89d}{finalize}}();}
\DoxyCodeLine{203 \textcolor{comment}{}}
\DoxyCodeLine{204 \textcolor{comment}{  /**}}
\DoxyCodeLine{205 \textcolor{comment}{   * @brief Update the constant contributions of all elements in a sparse system}}
\DoxyCodeLine{206 \textcolor{comment}{   *}}
\DoxyCodeLine{207 \textcolor{comment}{   * @param system System to update contributions at}}
\DoxyCodeLine{208 \textcolor{comment}{   */}}
\DoxyCodeLine{209   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ab251541e14d080d82639950015579413}{update\_constant}}(\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA::SparseSystem<T>}} \&system);}
\DoxyCodeLine{210 \textcolor{comment}{}}
\DoxyCodeLine{211 \textcolor{comment}{  /**}}
\DoxyCodeLine{212 \textcolor{comment}{   * @brief Update the time-\/dependent contributions of all elements in a sparse}}
\DoxyCodeLine{213 \textcolor{comment}{   * system}}
\DoxyCodeLine{214 \textcolor{comment}{   *}}
\DoxyCodeLine{215 \textcolor{comment}{   * @param system System to update contributions at}}
\DoxyCodeLine{216 \textcolor{comment}{   * @param time Current time}}
\DoxyCodeLine{217 \textcolor{comment}{   */}}
\DoxyCodeLine{218   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a7cb64c8d49c6dc41d2c00df1cc24132d}{update\_time}}(\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA::SparseSystem<T>}} \&system, T \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_abc13b2b82ef86f7042249678c2ae26f5}{time}});}
\DoxyCodeLine{219 \textcolor{comment}{}}
\DoxyCodeLine{220 \textcolor{comment}{  /**}}
\DoxyCodeLine{221 \textcolor{comment}{   * @brief Update the solution-\/dependent contributions of all elements in a}}
\DoxyCodeLine{222 \textcolor{comment}{   * sparse system}}
\DoxyCodeLine{223 \textcolor{comment}{   *}}
\DoxyCodeLine{224 \textcolor{comment}{   * @param system System to update contributions at}}
\DoxyCodeLine{225 \textcolor{comment}{   * @param y Current solution}}
\DoxyCodeLine{226 \textcolor{comment}{   * @param dy Current derivate of the solution}}
\DoxyCodeLine{227 \textcolor{comment}{   */}}
\DoxyCodeLine{228   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_acfea05375b2a4bdb53953f204e193019}{update\_solution}}(\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA::SparseSystem<T>}} \&system,}
\DoxyCodeLine{229                        Eigen::Matrix<T, Eigen::Dynamic, 1> \&y,}
\DoxyCodeLine{230                        Eigen::Matrix<T, Eigen::Dynamic, 1> \&dy);}
\DoxyCodeLine{231 \textcolor{comment}{}}
\DoxyCodeLine{232 \textcolor{comment}{  /**}}
\DoxyCodeLine{233 \textcolor{comment}{   * @brief Convert the blocks to a steady behavior}}
\DoxyCodeLine{234 \textcolor{comment}{   *}}
\DoxyCodeLine{235 \textcolor{comment}{   */}}
\DoxyCodeLine{236   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a6aca235e32671218c934c19395b9ff96}{to\_steady}}();}
\DoxyCodeLine{237 \textcolor{comment}{}}
\DoxyCodeLine{238 \textcolor{comment}{  /**}}
\DoxyCodeLine{239 \textcolor{comment}{   * @brief Convert the blocks to an unsteady behavior}}
\DoxyCodeLine{240 \textcolor{comment}{   *}}
\DoxyCodeLine{241 \textcolor{comment}{   */}}
\DoxyCodeLine{242   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_aae71072906c424697f7490fce4344020}{to\_unsteady}}();}
\DoxyCodeLine{243 \textcolor{comment}{}}
\DoxyCodeLine{244 \textcolor{comment}{  /**}}
\DoxyCodeLine{245 \textcolor{comment}{   * @brief Get number of triplets all elements}}
\DoxyCodeLine{246 \textcolor{comment}{   *}}
\DoxyCodeLine{247 \textcolor{comment}{   * Get the number of triplets the elements contribute to the global system}}
\DoxyCodeLine{248 \textcolor{comment}{   * (relevant for sparse memory reservation)}}
\DoxyCodeLine{249 \textcolor{comment}{   *}}
\DoxyCodeLine{250 \textcolor{comment}{   * @return Number of triplets that are used in each system matrix}}
\DoxyCodeLine{251 \textcolor{comment}{   */}}
\DoxyCodeLine{252   std::map<std::string, int> \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a0568bb6ffb0ee3e0ddba35ef9d1ce196}{get\_num\_triplets}}();}
\DoxyCodeLine{253 \textcolor{comment}{}}
\DoxyCodeLine{254 \textcolor{comment}{  /**}}
\DoxyCodeLine{255 \textcolor{comment}{   * @brief Get the number of blocks in the model}}
\DoxyCodeLine{256 \textcolor{comment}{   *}}
\DoxyCodeLine{257 \textcolor{comment}{   * @return int Number of blocks}}
\DoxyCodeLine{258 \textcolor{comment}{   */}}
\DoxyCodeLine{259   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a424f897ed3cb8f6830a2752d39bf9e2b}{get\_num\_blocks}}(\textcolor{keywordtype}{bool} internal = \textcolor{keyword}{false});}
\DoxyCodeLine{260 }
\DoxyCodeLine{261  \textcolor{keyword}{private}:}
\DoxyCodeLine{262   \textcolor{keywordtype}{int} block\_count = 0;}
\DoxyCodeLine{263   \textcolor{keywordtype}{int} node\_count = 0;}
\DoxyCodeLine{264   \textcolor{keywordtype}{int} parameter\_count = 0;}
\DoxyCodeLine{265   std::map<int, T> param\_value\_cache;}
\DoxyCodeLine{266 }
\DoxyCodeLine{267   std::vector<std::shared\_ptr<Block<T>>> blocks;  \textcolor{comment}{///< Blocks of the model}}
\DoxyCodeLine{268   std::vector<BlockType> block\_types;             \textcolor{comment}{///< Types of the blocks}}
\DoxyCodeLine{269   std::vector<std::string> block\_names;           \textcolor{comment}{///< Names of the blocks}}
\DoxyCodeLine{270   std::map<std::string, int>}
\DoxyCodeLine{271       block\_index\_map;  \textcolor{comment}{///< Map between block name and index}}
\DoxyCodeLine{272 }
\DoxyCodeLine{273   std::vector<std::shared\_ptr<Block<T>>>}
\DoxyCodeLine{274       hidden\_blocks;  \textcolor{comment}{///< Hidden blocks of the model}}
\DoxyCodeLine{275 }
\DoxyCodeLine{276   std::vector<std::shared\_ptr<Node<T>>> nodes;  \textcolor{comment}{///< Nodes of the model}}
\DoxyCodeLine{277   std::vector<std::string> node\_names;          \textcolor{comment}{///< Names of the nodes}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279   std::vector<Parameter<T>> parameters;  \textcolor{comment}{///< Parameters of the model}}
\DoxyCodeLine{280   std::vector<double> parameter\_values;  \textcolor{comment}{///< Current values of the parameters}}
\DoxyCodeLine{281 \};}
\DoxyCodeLine{282 }
\DoxyCodeLine{283 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{284 \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a75204aff4fddcf2032dd5c3e01c05433}{Model<T>::Model}}() \{\}}
\DoxyCodeLine{285 }
\DoxyCodeLine{286 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{287 \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_af906fc8d73cea59e804174a828468f23}{Model<T>::\string~Model}}() \{\}}
\DoxyCodeLine{288 }
\DoxyCodeLine{289 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{290 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_afbc4e91afadea5bddfc78241d54200c6}{Model<T>::add\_block}}(\mbox{\hyperlink{namespace_m_o_d_e_l_abfc4730d81d2da4910968e593aec2fe3}{BlockType}} block\_type,}
\DoxyCodeLine{291                         \textcolor{keyword}{const} std::vector<int> \&block\_param\_ids,}
\DoxyCodeLine{292                         std::string\_view name, \textcolor{keywordtype}{bool} internal) \{}
\DoxyCodeLine{293   DEBUG\_MSG(\textcolor{stringliteral}{"{}Adding block "{}} << name << \textcolor{stringliteral}{"{} with type "{}} << block\_type);}
\DoxyCodeLine{294   std::shared\_ptr<Block<T>> block;}
\DoxyCodeLine{295   \textcolor{keywordflow}{switch} (block\_type) \{}
\DoxyCodeLine{296     \textcolor{keywordflow}{case} BlockType::BLOODVESSEL:}
\DoxyCodeLine{297       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{298           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel}{BloodVessel<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{299       \textcolor{keywordflow}{break};}
\DoxyCodeLine{300     \textcolor{keywordflow}{case} BlockType::JUNCTION:}
\DoxyCodeLine{301       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{302           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{Junction<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{303       \textcolor{keywordflow}{break};}
\DoxyCodeLine{304     \textcolor{keywordflow}{case} BlockType::BLOODVESSELJUNCTION:}
\DoxyCodeLine{305       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{306           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel_junction}{BloodVesselJunction<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{307       \textcolor{keywordflow}{break};}
\DoxyCodeLine{308     \textcolor{keywordflow}{case} BlockType::RESISTIVEJUNCTION:}
\DoxyCodeLine{309       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{310           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_resistive_junction}{ResistiveJunction<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{311       \textcolor{keywordflow}{break};}
\DoxyCodeLine{312     \textcolor{keywordflow}{case} BlockType::FLOWBC:}
\DoxyCodeLine{313       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{314           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_flow_reference_b_c}{FlowReferenceBC<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{315       \textcolor{keywordflow}{break};}
\DoxyCodeLine{316     \textcolor{keywordflow}{case} BlockType::RESISTANCEBC:}
\DoxyCodeLine{317       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{318           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_resistance_b_c}{ResistanceBC<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{319       \textcolor{keywordflow}{break};}
\DoxyCodeLine{320     \textcolor{keywordflow}{case} BlockType::WINDKESSELBC:}
\DoxyCodeLine{321       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{322           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_windkessel_b_c}{WindkesselBC<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{323       \textcolor{keywordflow}{break};}
\DoxyCodeLine{324     \textcolor{keywordflow}{case} BlockType::PRESSUREBC:}
\DoxyCodeLine{325       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{326           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_pressure_reference_b_c}{PressureReferenceBC<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{327       \textcolor{keywordflow}{break};}
\DoxyCodeLine{328     \textcolor{keywordflow}{case} BlockType::OPENLOOPCORONARYBC:}
\DoxyCodeLine{329       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{330           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_open_loop_coronary_b_c}{OpenLoopCoronaryBC<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{331       \textcolor{keywordflow}{break};}
\DoxyCodeLine{332     \textcolor{keywordflow}{case} BlockType::CLOSEDLOOPCORONARYLEFTBC:}
\DoxyCodeLine{333       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{334           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_coronary_b_c}{ClosedLoopCoronaryBC<T, MODEL::Side::LEFT>}}(}
\DoxyCodeLine{335               block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{336       \textcolor{keywordflow}{break};}
\DoxyCodeLine{337     \textcolor{keywordflow}{case} BlockType::CLOSEDLOOPCORONARYRIGHTBC:}
\DoxyCodeLine{338       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{339           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_coronary_b_c}{ClosedLoopCoronaryBC<T, MODEL::Side::RIGHT>}}(}
\DoxyCodeLine{340               block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{341       \textcolor{keywordflow}{break};}
\DoxyCodeLine{342     \textcolor{keywordflow}{case} BlockType::CLOSEDLOOPRCRBC:}
\DoxyCodeLine{343       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{344           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_r_c_r_b_c}{ClosedLoopRCRBC<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{345       \textcolor{keywordflow}{break};}
\DoxyCodeLine{346     \textcolor{keywordflow}{case} BlockType::CLOSEDLOOPHEARTPULMONARY:}
\DoxyCodeLine{347       block = std::shared\_ptr<Block<T>>(}
\DoxyCodeLine{348           \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_heart_pulmonary}{ClosedLoopHeartPulmonary<T>}}(block\_count, block\_param\_ids, \textcolor{keyword}{this}));}
\DoxyCodeLine{349       \textcolor{keywordflow}{break};}
\DoxyCodeLine{350     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{351       \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{352           \textcolor{stringliteral}{"{}Adding block to model failed: Invalid block type!"{}});}
\DoxyCodeLine{353   \}}
\DoxyCodeLine{354   \textcolor{keyword}{auto} name\_string = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(name);}
\DoxyCodeLine{355   \textcolor{keywordflow}{if} (internal) \{}
\DoxyCodeLine{356     hidden\_blocks.push\_back(block);}
\DoxyCodeLine{357   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{358     blocks.push\_back(block);}
\DoxyCodeLine{359   \}}
\DoxyCodeLine{360   block\_types.push\_back(block\_type);}
\DoxyCodeLine{361   block\_index\_map.insert(\{name\_string, block\_count\});}
\DoxyCodeLine{362   block\_names.push\_back(name\_string);}
\DoxyCodeLine{363   \textcolor{keywordflow}{return} block\_count++;}
\DoxyCodeLine{364 \}}
\DoxyCodeLine{365 }
\DoxyCodeLine{366 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{367 \mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ac3ba9eb815bf3f94a35747034baa357c}{Model<T>::get\_block}}(std::string\_view name) \{}
\DoxyCodeLine{368   \textcolor{keyword}{auto} name\_string = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(name);}
\DoxyCodeLine{369   \textcolor{keywordflow}{if} (block\_index\_map.find(name\_string) == block\_index\_map.end()) \{}
\DoxyCodeLine{370     \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{371   \}}
\DoxyCodeLine{372   \textcolor{keywordflow}{return} blocks[block\_index\_map[name\_string]].get();}
\DoxyCodeLine{373 \}}
\DoxyCodeLine{374 }
\DoxyCodeLine{375 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{376 \mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ac3ba9eb815bf3f94a35747034baa357c}{Model<T>::get\_block}}(\textcolor{keywordtype}{int} block\_id) \{}
\DoxyCodeLine{377   \textcolor{keywordflow}{if} (block\_id >= blocks.size()) \{}
\DoxyCodeLine{378     \textcolor{keywordflow}{return} hidden\_blocks[block\_id -\/ blocks.size()].get();}
\DoxyCodeLine{379   \}}
\DoxyCodeLine{380   \textcolor{keywordflow}{return} blocks[block\_id].get();}
\DoxyCodeLine{381 \}}
\DoxyCodeLine{382 }
\DoxyCodeLine{383 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{384 \mbox{\hyperlink{namespace_m_o_d_e_l_abfc4730d81d2da4910968e593aec2fe3}{BlockType}} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a7b2952c25a762846f7cc4f9e5e07b1d9}{Model<T>::get\_block\_type}}(std::string\_view name) \{}
\DoxyCodeLine{385   \textcolor{keyword}{auto} name\_string = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(name);}
\DoxyCodeLine{386   \textcolor{keywordflow}{if} (block\_index\_map.find(name\_string) == block\_index\_map.end()) \{}
\DoxyCodeLine{387     \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Could not find block with name "{}} + name\_string);}
\DoxyCodeLine{388   \}}
\DoxyCodeLine{389   \textcolor{keywordflow}{return} block\_types[block\_index\_map[name\_string]];}
\DoxyCodeLine{390 \}}
\DoxyCodeLine{391 }
\DoxyCodeLine{392 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{393 std::string \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_aa208195d2e9db11fc256cea78882cc8d}{Model<T>::get\_block\_name}}(\textcolor{keywordtype}{int} block\_id) \{}
\DoxyCodeLine{394   \textcolor{keywordflow}{return} block\_names[block\_id];}
\DoxyCodeLine{395 \}}
\DoxyCodeLine{396 }
\DoxyCodeLine{397 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{398 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ac197ebdc9d40d717af919ddcdf6cc027}{Model<T>::add\_node}}(\textcolor{keyword}{const} std::vector<\mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *> \&inlet\_eles,}
\DoxyCodeLine{399                        \textcolor{keyword}{const} std::vector<\mbox{\hyperlink{class_m_o_d_e_l_1_1_block}{Block<T>}} *> \&outlet\_eles,}
\DoxyCodeLine{400                        std::string\_view name) \{}
\DoxyCodeLine{401   DEBUG\_MSG(\textcolor{stringliteral}{"{}Adding node "{}} << name);}
\DoxyCodeLine{402   \textcolor{keyword}{auto} node = std::shared\_ptr<Node<T>>(}
\DoxyCodeLine{403       \textcolor{keyword}{new} \mbox{\hyperlink{class_m_o_d_e_l_1_1_node}{Node<T>}}(node\_count, inlet\_eles, outlet\_eles, \textcolor{keyword}{this}));}
\DoxyCodeLine{404   nodes.push\_back(node);}
\DoxyCodeLine{405   node\_names.push\_back(\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(name));}
\DoxyCodeLine{406   \textcolor{keywordflow}{return} node\_count++;}
\DoxyCodeLine{407 \}}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{410 std::string \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a219de975b955d05c1ca165e230543acc}{Model<T>::get\_node\_name}}(\textcolor{keywordtype}{int} node\_id) \{}
\DoxyCodeLine{411   \textcolor{keywordflow}{return} node\_names[node\_id];}
\DoxyCodeLine{412 \}}
\DoxyCodeLine{413 }
\DoxyCodeLine{414 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{415 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a1840902a8446dd44f9f1c2c06021bcb0}{Model<T>::add\_parameter}}(T value) \{}
\DoxyCodeLine{416   parameters.push\_back(\mbox{\hyperlink{class_m_o_d_e_l_1_1_parameter}{Parameter<T>}}(parameter\_count, value));}
\DoxyCodeLine{417   parameter\_values.push\_back(parameters.back().get(0.0));}
\DoxyCodeLine{418   \textcolor{keywordflow}{return} parameter\_count++;}
\DoxyCodeLine{419 \}}
\DoxyCodeLine{420 }
\DoxyCodeLine{421 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{422 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a1840902a8446dd44f9f1c2c06021bcb0}{Model<T>::add\_parameter}}(\textcolor{keyword}{const} std::vector<T> \&times,}
\DoxyCodeLine{423                             \textcolor{keyword}{const} std::vector<T> \&values, \textcolor{keywordtype}{bool} periodic) \{}
\DoxyCodeLine{424   \textcolor{keyword}{auto} param = \mbox{\hyperlink{class_m_o_d_e_l_1_1_parameter}{Parameter<T>}}(parameter\_count, times, values, periodic);}
\DoxyCodeLine{425   \textcolor{keywordflow}{if} (periodic \&\& (param.isconstant == \textcolor{keyword}{false})) \{}
\DoxyCodeLine{426     \textcolor{keywordflow}{if} ((this-\/>cardiac\_cycle\_period > 0.0) \&\&}
\DoxyCodeLine{427         (param.cycle\_period != this-\/>cardiac\_cycle\_period)) \{}
\DoxyCodeLine{428       \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{429           \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in parameters"{}});}
\DoxyCodeLine{430     \}}
\DoxyCodeLine{431     this-\/>cardiac\_cycle\_period = param.cycle\_period;}
\DoxyCodeLine{432   \}}
\DoxyCodeLine{433   parameter\_values.push\_back(param.get(0.0));}
\DoxyCodeLine{434   parameters.push\_back(std::move(param));}
\DoxyCodeLine{435   \textcolor{keywordflow}{return} parameter\_count++;}
\DoxyCodeLine{436 \}}
\DoxyCodeLine{437 }
\DoxyCodeLine{438 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{439 \mbox{\hyperlink{class_m_o_d_e_l_1_1_parameter}{Parameter<T>}} *\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a3c1d8454b667144e39b42eff092ce360}{Model<T>::get\_parameter}}(\textcolor{keywordtype}{int} param\_id) \{}
\DoxyCodeLine{440   \textcolor{keywordflow}{return} \&parameters[param\_id];}
\DoxyCodeLine{441 \}}
\DoxyCodeLine{442 }
\DoxyCodeLine{443 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{444 T \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a25e0f6d6c25184d67b9785712418403c}{Model<T>::get\_parameter\_value}}(\textcolor{keywordtype}{int} param\_id) \{}
\DoxyCodeLine{445   \textcolor{keywordflow}{return} parameter\_values[param\_id];}
\DoxyCodeLine{446 \}}
\DoxyCodeLine{447 }
\DoxyCodeLine{448 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{449 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a6b16083a29f28a7a39f70129493757ee}{Model<T>::update\_parameter\_value}}(\textcolor{keywordtype}{int} param\_id, T param\_value) \{}
\DoxyCodeLine{450   parameter\_values[param\_id] = param\_value;}
\DoxyCodeLine{451 \}}
\DoxyCodeLine{452 }
\DoxyCodeLine{453 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{454 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a39e6cc04b346f894bff1f9dad54ae89d}{Model<T>::finalize}}() \{}
\DoxyCodeLine{455   DEBUG\_MSG(\textcolor{stringliteral}{"{}Setup degrees-\/of-\/freedom of nodes"{}});}
\DoxyCodeLine{456   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&node : nodes) \{}
\DoxyCodeLine{457     node-\/>setup\_dofs(dofhandler);}
\DoxyCodeLine{458   \}}
\DoxyCodeLine{459   DEBUG\_MSG(\textcolor{stringliteral}{"{}Setup degrees-\/of-\/freedom of blocks"{}});}
\DoxyCodeLine{460   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&block : blocks) \{}
\DoxyCodeLine{461     block-\/>setup\_dofs(dofhandler);}
\DoxyCodeLine{462   \}}
\DoxyCodeLine{463   DEBUG\_MSG(\textcolor{stringliteral}{"{}Setup model-\/dependent parameters"{}});}
\DoxyCodeLine{464   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&block : blocks) \{}
\DoxyCodeLine{465     block-\/>setup\_model\_dependent\_params();}
\DoxyCodeLine{466   \}}
\DoxyCodeLine{467   \textcolor{keywordflow}{if} (cardiac\_cycle\_period < 0.0) \{}
\DoxyCodeLine{468     cardiac\_cycle\_period = 1.0;}
\DoxyCodeLine{469   \}}
\DoxyCodeLine{470 \}}
\DoxyCodeLine{471 }
\DoxyCodeLine{472 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{473 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a424f897ed3cb8f6830a2752d39bf9e2b}{Model<T>::get\_num\_blocks}}(\textcolor{keywordtype}{bool} internal) \{}
\DoxyCodeLine{474   \textcolor{keywordtype}{int} num\_blocks = blocks.size();}
\DoxyCodeLine{475   \textcolor{keywordflow}{if} (internal) \{}
\DoxyCodeLine{476     num\_blocks += hidden\_blocks.size();}
\DoxyCodeLine{477   \}}
\DoxyCodeLine{478   \textcolor{keywordflow}{return} num\_blocks;}
\DoxyCodeLine{479 \}}
\DoxyCodeLine{480 }
\DoxyCodeLine{481 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{482 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_ab251541e14d080d82639950015579413}{Model<T>::update\_constant}}(\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA::SparseSystem<T>}} \&system) \{}
\DoxyCodeLine{483   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} block : blocks) \{}
\DoxyCodeLine{484     block-\/>update\_constant(system, parameter\_values);}
\DoxyCodeLine{485   \}}
\DoxyCodeLine{486 \}}
\DoxyCodeLine{487 }
\DoxyCodeLine{488 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{489 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a7cb64c8d49c6dc41d2c00df1cc24132d}{Model<T>::update\_time}}(\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA::SparseSystem<T>}} \&system, T time) \{}
\DoxyCodeLine{490   this-\/>time = time;}
\DoxyCodeLine{491   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&param : parameters) \{}
\DoxyCodeLine{492     parameter\_values[param.id] = param.get(time);}
\DoxyCodeLine{493   \}}
\DoxyCodeLine{494   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} block : blocks) \{}
\DoxyCodeLine{495     block-\/>update\_time(system, parameter\_values);}
\DoxyCodeLine{496   \}}
\DoxyCodeLine{497 \}}
\DoxyCodeLine{498 }
\DoxyCodeLine{499 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{500 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_acfea05375b2a4bdb53953f204e193019}{Model<T>::update\_solution}}(\mbox{\hyperlink{class_a_l_g_e_b_r_a_1_1_sparse_system}{ALGEBRA::SparseSystem<T>}} \&system,}
\DoxyCodeLine{501                                Eigen::Matrix<T, Eigen::Dynamic, 1> \&y,}
\DoxyCodeLine{502                                Eigen::Matrix<T, Eigen::Dynamic, 1> \&dy) \{}
\DoxyCodeLine{503   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} block : blocks) \{}
\DoxyCodeLine{504     block-\/>update\_solution(system, parameter\_values, y, dy);}
\DoxyCodeLine{505   \}}
\DoxyCodeLine{506 \}}
\DoxyCodeLine{507 }
\DoxyCodeLine{508 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{509 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a6aca235e32671218c934c19395b9ff96}{Model<T>::to\_steady}}() \{}
\DoxyCodeLine{510   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&param : parameters) \{}
\DoxyCodeLine{511     param.to\_steady();}
\DoxyCodeLine{512   \}}
\DoxyCodeLine{513   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < get\_num\_blocks(\textcolor{keyword}{true}); i++) \{}
\DoxyCodeLine{514     get\_block(i)-\/>steady = \textcolor{keyword}{true};}
\DoxyCodeLine{515     \textcolor{keywordflow}{if} ((block\_types[i] == BlockType::WINDKESSELBC) ||}
\DoxyCodeLine{516         (block\_types[i] == BlockType::CLOSEDLOOPRCRBC)) \{}
\DoxyCodeLine{517       \textcolor{keywordtype}{int} param\_id\_capacitance = blocks[i]-\/>global\_param\_ids[1];}
\DoxyCodeLine{518       T value = parameters[param\_id\_capacitance].get(0.0);}
\DoxyCodeLine{519       param\_value\_cache.insert(\{param\_id\_capacitance, value\});}
\DoxyCodeLine{520       parameters[param\_id\_capacitance].update(0.0);}
\DoxyCodeLine{521     \}}
\DoxyCodeLine{522   \}}
\DoxyCodeLine{523 \}}
\DoxyCodeLine{524 }
\DoxyCodeLine{525 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{526 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_aae71072906c424697f7490fce4344020}{Model<T>::to\_unsteady}}() \{}
\DoxyCodeLine{527   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&param : parameters) \{}
\DoxyCodeLine{528     param.to\_unsteady();}
\DoxyCodeLine{529   \}}
\DoxyCodeLine{530   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[param\_id\_capacitance, value] : param\_value\_cache) \{}
\DoxyCodeLine{531     DEBUG\_MSG(\textcolor{stringliteral}{"{}Setting Windkessel capacitance back to "{}} << value);}
\DoxyCodeLine{532     parameters[param\_id\_capacitance].update(value);}
\DoxyCodeLine{533   \}}
\DoxyCodeLine{534   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < get\_num\_blocks(\textcolor{keyword}{true}); i++) \{}
\DoxyCodeLine{535     get\_block(i)-\/>steady = \textcolor{keyword}{false};}
\DoxyCodeLine{536   \}}
\DoxyCodeLine{537 \}}
\DoxyCodeLine{538 }
\DoxyCodeLine{539 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{540 std::map<std::string, int> \mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a0568bb6ffb0ee3e0ddba35ef9d1ce196}{Model<T>::get\_num\_triplets}}() \{}
\DoxyCodeLine{541   std::map<std::string, int> num\_triplets = \{}
\DoxyCodeLine{542       \{\textcolor{stringliteral}{"{}F"{}}, 0\},}
\DoxyCodeLine{543       \{\textcolor{stringliteral}{"{}E"{}}, 0\},}
\DoxyCodeLine{544       \{\textcolor{stringliteral}{"{}D"{}}, 0\},}
\DoxyCodeLine{545   \};}
\DoxyCodeLine{546   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&elem : blocks) \{}
\DoxyCodeLine{547     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, value] : elem-\/>get\_num\_triplets()) \{}
\DoxyCodeLine{548       num\_triplets[key] += value;}
\DoxyCodeLine{549     \}}
\DoxyCodeLine{550   \}}
\DoxyCodeLine{551   \textcolor{keywordflow}{return} num\_triplets;}
\DoxyCodeLine{552 \}}
\DoxyCodeLine{553 }
\DoxyCodeLine{554 \}  \textcolor{comment}{// namespace MODEL}}
\DoxyCodeLine{555 }
\DoxyCodeLine{556 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// SVZERODSOLVER\_MODEL\_MODEL\_HPP\_}}

\end{DoxyCode}
