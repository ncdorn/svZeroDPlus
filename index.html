<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>svZeroDSolver: svZeroDSolver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">svZeroDSolver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">svZeroDSolver </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md52">Installation</a><ul><li class="level2"><a href="#autotoc_md53">Using pip</a></li>
<li class="level2"><a href="#autotoc_md54">Using CMake</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md55">Developer Guide</a></li>
<li class="level1"><a href="#autotoc_md56">svZeroDSolver</a><ul><li class="level2"><a href="#autotoc_md57">Run svZeroDSolver from the command line</a></li>
<li class="level2"><a href="#autotoc_md58">Run svZeroDSolver from other programs</a><ul><li class="level3"><a href="#autotoc_md59">In C++</a></li>
<li class="level3"><a href="#autotoc_md60">In Python</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md61">Configuration</a><ul><li class="level3"><a href="#autotoc_md62">Simulation parameters</a></li>
<li class="level3"><a href="#autotoc_md63">Vessels</a></li>
<li class="level3"><a href="#autotoc_md64">Junctions</a></li>
<li class="level3"><a href="#autotoc_md65">Boundary conditions</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md66">svZeroDCalibrator</a><ul><li class="level2"><a href="#autotoc_md67">Run svZeroDCalibrator</a><ul><li class="level3"><a href="#autotoc_md68">From the command line</a></li>
<li class="level3"><a href="#autotoc_md69">In Python</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md70">Configuration (file)</a><ul><li class="level3"><a href="#autotoc_md71">Calibration parameters</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>svZeroDSolver is an application for performing simulations with 0D/lumped-parameter computer models for cardiovascular flows.</p>
<p>Some noteworthy features of svZeroDSolver are:</p><ul>
<li>It is completely modular. Users can create custom flow models by arranging blocks corresponding to blood vessels, junctions, different types of boundary conditions, etc.</li>
<li>It is written in C++ to enable high-performance applications.</li>
<li>svZeroDSolver offers both a Python API and a C++ shared library to interface with other Python or C++-based applications. This allows it to be used in a fully coupled manner with other multi-physics solvers, and for parameter estimation, uncertainty quantification, etc.</li>
<li>The svZeroDCalibrator application, which is included in svZeroDSolver, optimizes 0D blood vessel parameters to recapitulate given time-varying flow and pressure measurements (for example, from a high-fidelity 3D simulation). This allows users to build accurate 0D models that reflect observed hemodynamics.</li>
</ul>
<p>Zero-dimensional (0D) models are lightweight methods to simulate bulk hemodynamic quantities in the cardiovascular system. Unlike 3D and 1D models, 0D models are purely time-dependent; they are unable to simulate spatial patterns in the hemodynamics. 0D models are analogous to electrical circuits. The flow rate simulated by 0D models represents electrical current, while the pressure represents voltage. Three primary building blocks of 0D models are resistors, capacitors, and inductors Resistance captures the viscous effects of blood flow, capacitance represents the compliance and distensibility of the vessel wall, and inductance represents the inertia of the blood flow. Different combinations of these building blocks, as well as others, can be formed to reflect the hemodynamics and physiology of different cardiovascular anatomies. These 0D models are governed by differential algebraic equations (DAEs).</p>
<p>For more background information on 0D models, have a look at the detailed documentation:</p><ul>
<li>System of equations: <a class="el" href="class_sparse_system.html" title="Sparse system.">SparseSystem</a></li>
<li>Time integration: <a class="el" href="class_integrator.html" title="Generalized-alpha integrator.">Integrator</a></li>
<li>Overview of available 0D elements (blocks): <a class="el" href="class_block.html" title="Base class for 0D model components.">Block</a></li>
</ul>
<p>You can find more details about governing equations in individual blocks, for example:</p><ul>
<li><a class="el" href="class_blood_vessel.html" title="Resistor-capacitor-inductor blood vessel with optional stenosis.">BloodVessel</a></li>
<li><a class="el" href="class_blood_vessel_junction.html" title="Junction between blood vessels.">BloodVesselJunction</a></li>
<li><a class="el" href="class_windkessel_b_c.html" title="Windkessel RCR boundary condition.">WindkesselBC</a></li>
</ul>
<p>For implementation details, have a look at the <a href="https://github.com/simvascular/svZeroDSolver">source code</a>.</p>
<p><a href="https://simvascular.github.io">About SimVascular</a></p>
<h1><a class="anchor" id="autotoc_md52"></a>
Installation</h1>
<p>svZeroDSolver can be installed in two different ways. For using the Python API, an installation via pip is recommended.</p>
<h2><a class="anchor" id="autotoc_md53"></a>
Using pip</h2>
<p>For a pip installation, simply run the following command (cloning of the repository is not required):</p>
<div class="fragment"><div class="line">pip install git+https://github.com/simvascular/svZeroDSolver.git</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md54"></a>
Using CMake</h2>
<p>If you want to build svZeroDSolver manually from source, clone the repository and run the following commands from the top directory of the project:</p>
<div class="fragment"><div class="line">mkdir Release</div>
<div class="line">cd Release</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Release ..</div>
<div class="line">cmake --build .</div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd><details >
<summary >
<b>Building on Sherlock</b></summary>
<p></p>
<div class="fragment"><div class="line">module load cmake/3.23.1 gcc/12.1.0 binutils/2.38</div>
<div class="line">mkdir Release</div>
<div class="line">cd Release</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_COMPILER=/share/software/user/open/gcc/12.1.0/bin/g++ -DCMAKE_C_COMPILER=/share/software/user/open/gcc/12.1.0/bin/gcc ..</div>
<div class="line">cmake --build .</div>
</div><!-- fragment --><p></p>
</details>
</dd></dl>
<h1><a class="anchor" id="autotoc_md55"></a>
Developer Guide</h1>
<p>If you are a developer and want to contribute to svZeroDSolver, you can find more helpful information in our <a class="el" href="developer_guide.html">Developer Guide</a>.</p>
<h1><a class="anchor" id="autotoc_md56"></a>
svZeroDSolver</h1>
<p>svZeroDSolver can be used to run zero-dimensional (0D) cardiovascular simulations based on a given configuration.</p>
<h2><a class="anchor" id="autotoc_md57"></a>
Run svZeroDSolver from the command line</h2>
<p>svZeroDSolver can be executed from the command line using a JSON configuration file.</p>
<div class="fragment"><div class="line">svzerodsolver tests/cases/steadyFlow_RLC_R.json result_steadyFlow_RLC_R.csv</div>
</div><!-- fragment --><p>The result will be written to a csv file.</p>
<h2><a class="anchor" id="autotoc_md58"></a>
Run svZeroDSolver from other programs</h2>
<p>For some applications it is beneficial to run svZeroDSolver directly from within another program. For example, this can be useful when many simulations need to be performed (e.g. for calibration, uncertainty quantification, ...). It is also allows using svZeroDSolver with other solvers, for example as boundary conditions or forcing terms.</p>
<h3><a class="anchor" id="autotoc_md59"></a>
In C++</h3>
<p>SvZeroDSolver needs to be built using CMake to use the shared library interface.</p>
<p>Detailed examples of interfacing with svZeroDSolver from C++ codes are available in the test cases at <code>svZeroDSolver/tests/test_interface</code>.</p>
<h3><a class="anchor" id="autotoc_md60"></a>
In Python</h3>
<p>Please make sure that you installed svZerodSolver via pip to enable this feature. We start by importing pysvzerod:</p>
<div class="fragment"><div class="line">&gt;&gt;&gt; <span class="keyword">import</span> pysvzerod</div>
</div><!-- fragment --><p>Next, we create a solver from our configuration. The configuration can be specified by either a path to a JSON file:</p>
<div class="fragment"><div class="line">&gt;&gt;&gt; solver = pysvzerod.Solver(<span class="stringliteral">&quot;tests/cases/steadyFlow_RLC_R.json&quot;</span>)</div>
</div><!-- fragment --><p>or as a Python dictionary:</p>
<div class="fragment"><div class="line">&gt;&gt;&gt; my_config = {...}</div>
<div class="line">&gt;&gt;&gt; solver = pysvzerod.Solver(my_config)</div>
</div><!-- fragment --><p>To run the simulation we add:</p>
<div class="fragment"><div class="line">&gt;&gt;&gt; solver.run()</div>
</div><!-- fragment --><p>The simulation result is now saved in the solver instance. We can obtain results for individual degrees-of-freedom (DOFs) as </p><div class="fragment"><div class="line">&gt;&gt;&gt; solver.get_single_result(<span class="stringliteral">&quot;flow:INFLOW:branch0_seg0&quot;</span>)</div>
<div class="line"> </div>
<div class="line">array([5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,</div>
<div class="line">       5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,</div>
<div class="line">       5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,</div>
<div class="line">       5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,</div>
<div class="line">       5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.,</div>
<div class="line">       5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5., 5.])</div>
</div><!-- fragment --><p> The naming of the DOFs is similar to how results are written if the simulation option <code>output_variable_based</code> is activated (see below). We can also obtain the mean result for a DOF over time with: </p><div class="fragment"><div class="line">&gt;&gt;&gt; solver.get_single_result_avg(<span class="stringliteral">&quot;flow:INFLOW:branch0_seg0&quot;</span>)</div>
<div class="line"> </div>
<div class="line">5.0</div>
</div><!-- fragment --><p>Or the result of the full simulation as a pandas data frame:</p>
<div class="fragment"><div class="line">&gt;&gt;&gt; solver.get_full_result()</div>
<div class="line"> </div>
<div class="line">             name  time  flow_in  flow_out  pressure_in  pressure_out</div>
<div class="line">0    branch0_seg0  0.00      5.0       5.0       1100.0         600.0</div>
<div class="line">1    branch0_seg0  0.01      5.0       5.0       1100.0         600.0</div>
<div class="line">2    branch0_seg0  0.02      5.0       5.0       1100.0         600.0</div>
<div class="line">3    branch0_seg0  0.03      5.0       5.0       1100.0         600.0</div>
<div class="line">4    branch0_seg0  0.04      5.0       5.0       1100.0         600.0</div>
<div class="line">..            ...   ...      ...       ...          ...           ...</div>
<div class="line">96   branch0_seg0  0.96      5.0       5.0       1100.0         600.0</div>
<div class="line">97   branch0_seg0  0.97      5.0       5.0       1100.0         600.0</div>
<div class="line">98   branch0_seg0  0.98      5.0       5.0       1100.0         600.0</div>
<div class="line">99   branch0_seg0  0.99      5.0       5.0       1100.0         600.0</div>
<div class="line">100  branch0_seg0  1.00      5.0       5.0       1100.0         600.0</div>
<div class="line"> </div>
<div class="line">[101 rows x 6 columns]</div>
</div><!-- fragment --><p>There is also a function to retrieve the full result directly based on a given configuration:</p>
<div class="fragment"><div class="line">&gt;&gt;&gt; my_config = {...}</div>
<div class="line">&gt;&gt;&gt; pysvzerod.simulate(my_config)</div>
<div class="line"> </div>
<div class="line">             name  time  flow_in  flow_out  pressure_in  pressure_out</div>
<div class="line">0    branch0_seg0  0.00      5.0       5.0       1100.0         600.0</div>
<div class="line">1    branch0_seg0  0.01      5.0       5.0       1100.0         600.0</div>
<div class="line">2    branch0_seg0  0.02      5.0       5.0       1100.0         600.0</div>
<div class="line">3    branch0_seg0  0.03      5.0       5.0       1100.0         600.0</div>
<div class="line">4    branch0_seg0  0.04      5.0       5.0       1100.0         600.0</div>
<div class="line">..            ...   ...      ...       ...          ...           ...</div>
<div class="line">96   branch0_seg0  0.96      5.0       5.0       1100.0         600.0</div>
<div class="line">97   branch0_seg0  0.97      5.0       5.0       1100.0         600.0</div>
<div class="line">98   branch0_seg0  0.98      5.0       5.0       1100.0         600.0</div>
<div class="line">99   branch0_seg0  0.99      5.0       5.0       1100.0         600.0</div>
<div class="line">100  branch0_seg0  1.00      5.0       5.0       1100.0         600.0</div>
<div class="line"> </div>
<div class="line">[101 rows x 6 columns]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md61"></a>
Configuration</h2>
<p>svZeroDSolver is configured using either a JSON file or a Python dictionary. The top-level structure of both is:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;simulation_parameters&quot;</span>: {...},</div>
<div class="line">    <span class="stringliteral">&quot;vessels&quot;</span>: [...],</div>
<div class="line">    <span class="stringliteral">&quot;junctions&quot;</span>: [...],</div>
<div class="line">    <span class="stringliteral">&quot;boundary_conditions&quot;</span>: [...]</div>
<div class="line">}</div>
</div><!-- fragment --><p>In the following sections, the individual categories are described in more detail.</p>
<h3><a class="anchor" id="autotoc_md62"></a>
Simulation parameters</h3>
<p>The svZeroDSolver can be configured with the following options in the <code>simulation_parameters</code> section of the input file. Parameters without a default value must be specified.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="class_parameter.html" title="Model Parameter.">Parameter</a> key   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">number_of_cardiac_cycles   </td><td class="markdownTableBodyNone">Number of cardiac cycles to simulate   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">number_of_time_pts_per_cardiac_cycle   </td><td class="markdownTableBodyNone">Number of time steps per cardiac cycle   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">absolute_tolerance   </td><td class="markdownTableBodyNone">Absolute tolerance for time integration   </td><td class="markdownTableBodyNone"><picture><source srcset="form_173_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$10^{-8}$" src="form_173.png" width="25" height="11"/></picture>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">maximum_nonlinear_iterations   </td><td class="markdownTableBodyNone">Maximum number of nonlinear iterations for time integration   </td><td class="markdownTableBodyNone"><picture><source srcset="form_174_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$30$" src="form_174.png" width="14" height="9"/></picture>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">steady_initial   </td><td class="markdownTableBodyNone">Toggle whether to use the steady solution as the initial condition for the simulation   </td><td class="markdownTableBodyNone">true    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">output_variable_based   </td><td class="markdownTableBodyNone">Output solution based on variables (i.e. flow+pressure at nodes and internal variables)   </td><td class="markdownTableBodyNone">false    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">output_interval   </td><td class="markdownTableBodyNone">The frequency of writing timesteps to the output (1 means every time step is written to output)   </td><td class="markdownTableBodyNone"><picture><source srcset="form_175_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$1$" src="form_175.png" width="5" height="9"/></picture>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">output_mean_only   </td><td class="markdownTableBodyNone">Write only the mean values over every timestep to output file   </td><td class="markdownTableBodyNone">false    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">output_derivative   </td><td class="markdownTableBodyNone">Write time derivatives to output file   </td><td class="markdownTableBodyNone">false    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">output_all_cycles   </td><td class="markdownTableBodyNone">Write all cardiac cycles to output file   </td><td class="markdownTableBodyNone">false   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md63"></a>
Vessels</h3>
<p>More information about the vessels can be found in their respective class references.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;boundary_conditions&quot;</span>: {</div>
<div class="line">        <span class="stringliteral">&quot;inlet&quot;</span>: <span class="stringliteral">&quot;INFLOW&quot;</span>, <span class="comment"># Optional: Name of inlet boundary condition</span></div>
<div class="line">        <span class="stringliteral">&quot;outlet&quot;</span>: <span class="stringliteral">&quot;OUT&quot;</span>, <span class="comment"># Optional: Name of outlet boundary condition</span></div>
<div class="line">    },</div>
<div class="line">    <span class="stringliteral">&quot;vessel_id&quot;</span>: 0, <span class="comment"># ID of the vessel</span></div>
<div class="line">    <span class="stringliteral">&quot;vessel_name&quot;</span>: <span class="stringliteral">&quot;branch0_seg0&quot;</span>, <span class="comment"># Name of vessel</span></div>
<div class="line">    <span class="stringliteral">&quot;zero_d_element_type&quot;</span>: <span class="stringliteral">&quot;BloodVessel&quot;</span>, <span class="comment"># Type of vessel</span></div>
<div class="line">    <span class="stringliteral">&quot;zero_d_element_values&quot;</span>: {...} <span class="comment"># Values for configuration parameters</span></div>
<div class="line">}</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Class   </th><th class="markdownTableHeadNone"><code>zero_d_element_type</code>   </th><th class="markdownTableHeadNone"><code>zero_d_element_values</code>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Blood vessel with <br  />
 optional stenosis   </td><td class="markdownTableBodyNone">MODEL::BloodVessel   </td><td class="markdownTableBodyNone"><code><a class="el" href="class_blood_vessel.html" title="Resistor-capacitor-inductor blood vessel with optional stenosis.">BloodVessel</a></code>   </td><td class="markdownTableBodyNone"><code>C</code>: Capacity <br  />
 <code>L</code>: Inductance <br  />
 <code>R_poiseuille</code>: Poiseuille resistance <br  />
 <code>stenosis_coefficient</code>: Stenosis coefficient   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md64"></a>
Junctions</h3>
<p>More information about the junctions can be found in their respective class references.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;junction_name&quot;</span>: <span class="stringliteral">&quot;J0&quot;</span>, <span class="comment"># Name of the junction</span></div>
<div class="line">    <span class="stringliteral">&quot;junction_type&quot;</span>: <span class="stringliteral">&quot;BloodVesselJunction&quot;</span>, <span class="comment"># Type of the junction</span></div>
<div class="line">    <span class="stringliteral">&quot;inlet_vessels&quot;</span>: [0], <span class="comment"># List of vessel IDs connected to the inlet</span></div>
<div class="line">    <span class="stringliteral">&quot;outlet_vessels&quot;</span>: [1, 2], <span class="comment"># List of vessel IDs connected to the inlet</span></div>
<div class="line">    <span class="stringliteral">&quot;junction_values&quot;</span>: {...} <span class="comment"># Values for configuration parameters</span></div>
<div class="line">}</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Class   </th><th class="markdownTableHeadNone"><code>junction_type</code>   </th><th class="markdownTableHeadNone"><code>junction_values</code>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Purely mass <br  />
 conserving <br  />
 junction   </td><td class="markdownTableBodyNone">MODEL::Junction   </td><td class="markdownTableBodyNone"><code>NORMAL_JUNCTION</code>   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Resistive <br  />
 junction   </td><td class="markdownTableBodyNone">MODEL::ResistiveJunction   </td><td class="markdownTableBodyNone"><code>resistive_junction</code>   </td><td class="markdownTableBodyNone"><code>R</code>: Ordered list of resistances for all inlets and outlets    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Blood vessel <br  />
 junction   </td><td class="markdownTableBodyNone">MODEL::BloodVesselJunction   </td><td class="markdownTableBodyNone"><code><a class="el" href="class_blood_vessel_junction.html" title="Junction between blood vessels.">BloodVesselJunction</a></code>   </td><td class="markdownTableBodyNone">Same as for <code><a class="el" href="class_blood_vessel.html" title="Resistor-capacitor-inductor blood vessel with optional stenosis.">BloodVessel</a></code> element but <br  />
 as ordered list for each inlet and outlet   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md65"></a>
Boundary conditions</h3>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;bc_name&quot;</span>: <span class="stringliteral">&quot;INFLOW&quot;</span>, <span class="comment"># Name of the boundary condition</span></div>
<div class="line">    <span class="stringliteral">&quot;bc_type&quot;</span>: <span class="stringliteral">&quot;FLOW&quot;</span>, <span class="comment"># Type of the boundary condition</span></div>
<div class="line">    <span class="stringliteral">&quot;bc_values&quot;</span>: {...} <span class="comment"># Values for configuration parameters</span></div>
<div class="line">},</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Class   </th><th class="markdownTableHeadNone"><code>bc_type</code>   </th><th class="markdownTableHeadNone"><code>bc_values</code>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Prescribed (transient) flow   </td><td class="markdownTableBodyNone">MODEL::FlowReferenceBC   </td><td class="markdownTableBodyNone"><code>FLOW</code>   </td><td class="markdownTableBodyNone"><code>Q</code>: Time-dependent flow values <br  />
 <code>t</code>: Time stamps    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Prescribed (transient) pressure   </td><td class="markdownTableBodyNone">MODEL::PressureReferenceBC   </td><td class="markdownTableBodyNone"><code>PRESSURE</code>   </td><td class="markdownTableBodyNone"><code>P</code>: Time-dependent pressure values <br  />
 <code>t</code>: Time stamps    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Resistance   </td><td class="markdownTableBodyNone">MODEL::ResistanceBC   </td><td class="markdownTableBodyNone"><code>RESISTANCE</code>   </td><td class="markdownTableBodyNone"><code>R</code>: Resistance <br  />
 <code>Pd</code>: Time-dependent distal pressure <br  />
 <code>t</code>: Time stamps    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Windkessel   </td><td class="markdownTableBodyNone">MODEL::WindkesselBC   </td><td class="markdownTableBodyNone"><code>RCR</code>   </td><td class="markdownTableBodyNone"><code>Rp</code>: Proximal resistance <br  />
 <code>C</code>: Capacitance <br  />
 <code>Rd</code>: Distal resistance <br  />
 <code>Pd</code>: Distal pressure   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md66"></a>
svZeroDCalibrator</h1>
<p>svZeroDCalibrator can be used to calibrate cardiovascular 0D models (i.e. infer optimal parameters for the 0D elements) based on a given transient result (i.e. from a 3D simulation).</p>
<h2><a class="anchor" id="autotoc_md67"></a>
Run svZeroDCalibrator</h2>
<h3><a class="anchor" id="autotoc_md68"></a>
From the command line</h3>
<p>svZeroDCalibrator can be executed from the command line using a JSON configuration file.</p>
<div class="fragment"><div class="line">svzerodcalibrator path/to/input_file.json path/to/output_file.json</div>
</div><!-- fragment --><p>The result will be written to a JSON file.</p>
<h3><a class="anchor" id="autotoc_md69"></a>
In Python</h3>
<p>svZeroDCalibrator can also be called directly from Python. Please make sure that you installed svZerodSolver via pip to enable this feature. We start by importing pysvzerod:</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> pysvzerod</div>
<div class="line"> </div>
<div class="line">my_unoptimized_config = {...}</div>
<div class="line">my_optimized_config = pysvzerod.calibrate(my_unoptimized_config)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md70"></a>
Configuration (file)</h2>
<p>In order to make svZeroDCalibrator easy to use, it is based on a similar configuration file than svZeroDSolver. Instead of the <code>simulation_parameters</code> section, it has a section called <code>calibration_parameters</code>. Additionally the optimization target (i.e. a given) 3D result is passed with the key <code>y</code> and it's temporal derivative via <code>dy</code>. See <code>tests/cases/steadyFlow_calibration.json</code> for an example input file.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;calibration_parameters&quot;</span>: {...},</div>
<div class="line">    <span class="stringliteral">&quot;vessels&quot;</span>: [...],</div>
<div class="line">    <span class="stringliteral">&quot;junctions&quot;</span>: [...],</div>
<div class="line">    <span class="stringliteral">&quot;boundary_conditions&quot;</span>: [...],</div>
<div class="line">    <span class="stringliteral">&quot;y&quot;</span>: {</div>
<div class="line">      <span class="stringliteral">&quot;flow:INFLOW:branch0_seg0&quot;</span>: [0.0, 0.1, ...],  <span class="comment"># Time series for DOF</span></div>
<div class="line">      <span class="stringliteral">&quot;pressure:INFLOW:branch0_seg0&quot;</span>: [0.0, 0.1, ...],  <span class="comment"># Time series for DOF</span></div>
<div class="line">      ...</div>
<div class="line">    },</div>
<div class="line">    <span class="stringliteral">&quot;dy&quot;</span>: {</div>
<div class="line">      <span class="stringliteral">&quot;flow:INFLOW:branch0_seg0&quot;</span>: [0.0, 0.1, ...],  <span class="comment"># Time series for DOF</span></div>
<div class="line">      <span class="stringliteral">&quot;pressure:INFLOW:branch0_seg0&quot;</span>: [0.0, 0.1, ...],  <span class="comment"># Time series for DOF</span></div>
<div class="line">      ...</div>
<div class="line">    },</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md71"></a>
Calibration parameters</h3>
<p>Here is a list of the parameters that can be specified in the <code>calibration_parameters</code> section of the configuration file.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="class_parameter.html" title="Model Parameter.">Parameter</a> key   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">tolerance_gradient   </td><td class="markdownTableBodyNone">Gradient tolerance for calibration   </td><td class="markdownTableBodyNone"><picture><source srcset="form_176_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$10^{-5}$" src="form_176.png" width="25" height="11"/></picture>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">tolerance_increment   </td><td class="markdownTableBodyNone">Increment tolerance for calibration   </td><td class="markdownTableBodyNone"><picture><source srcset="form_177_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$10^{-10}$" src="form_177.png" width="30" height="11"/></picture>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">maximum_iterations   </td><td class="markdownTableBodyNone">Maximum calibration iterations   </td><td class="markdownTableBodyNone">100    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">calibrate_stenosis_coefficient   </td><td class="markdownTableBodyNone">Toggle whether stenosis coefficient should be calibrated   </td><td class="markdownTableBodyNone">True    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">set_capacitance_to_zero   </td><td class="markdownTableBodyNone">Toggle whether all capacitances should be manually set to zero   </td><td class="markdownTableBodyNone">False    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">initial_damping_factor   </td><td class="markdownTableBodyNone">Initial damping factor for Levenberg-Marquardt optimization   </td><td class="markdownTableBodyNone">1.0   </td></tr>
</table>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
